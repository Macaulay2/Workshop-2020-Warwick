(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12454,        336]
NotebookOptionsPosition[     10648,        295]
NotebookOutlinePosition[     11044,        311]
CellTagsIndexPosition[     11001,        308]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"numVar", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTrials", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"listCoef", "=", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{"1000", ",", 
    RowBox[{"{", 
     RowBox[{"numTrials", ",", "numVar"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.863158244873234*^9, 3.863158368163331*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"035f4b7c-e822-4e5e-b762-8e43c803c8d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "93", ",", "742", ",", "552", ",", "568", ",", "549", ",", "136", ",", 
     "874", ",", "465", ",", "3", ",", "254", ",", "112", ",", "203"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "747", ",", "556", ",", "824", ",", "869", ",", "441", ",", "748", ",", 
     "395", ",", "614", ",", "536", ",", "511", ",", "326", ",", "840"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "444", ",", "784", ",", "691", ",", "832", ",", "859", ",", "185", ",", 
     "402", ",", "435", ",", "72", ",", "762", ",", "555", ",", "122"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "477", ",", "241", ",", "993", ",", "60", ",", "744", ",", "402", ",", 
     "804", ",", "614", ",", "465", ",", "797", ",", "164", ",", "80"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "67", ",", "319", ",", "87", ",", "542", ",", "596", ",", "872", ",", 
     "349", ",", "918", ",", "278", ",", "468", ",", "578", ",", "701"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "605", ",", "930", ",", "343", ",", "229", ",", "350", ",", "441", ",", 
     "803", ",", "515", ",", "321", ",", "557", ",", "314", ",", "603"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "272", ",", "724", ",", "750", ",", "126", ",", "501", ",", "928", ",", 
     "931", ",", "340", ",", "513", ",", "484", ",", "199", ",", "746"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "572", ",", "889", ",", "475", ",", "307", ",", "823", ",", "855", ",", 
     "221", ",", "503", ",", "853", ",", "344", ",", "461", ",", "525"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "47", ",", "941", ",", "538", ",", "777", ",", "425", ",", "557", ",", 
     "657", ",", "269", ",", "54", ",", "510", ",", "444", ",", "104"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "369", ",", "443", ",", "132", ",", "919", ",", "631", ",", "709", ",", 
     "570", ",", "572", ",", "353", ",", "908", ",", "680", ",", "894"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.863158356114586*^9, 3.863158368658765*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"8ff6bc2c-792e-4a31-82a5-af3672736709"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"K", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l1", ",", "l6", ",", "0", ",", "l9", ",", "l10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l6", ",", "l2", ",", "l7", ",", "0", ",", "l11"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "l7", ",", "l3", ",", "l8", ",", "l12"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l9", ",", "0", ",", "l8", ",", "l4", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l10", ",", "l11", ",", "l12", ",", "0", ",", "l5"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.86315840483357*^9, 3.8631584668825283`*^9}, {
  3.863158829992998*^9, 3.863158878463682*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"7c0293f1-c2e4-43c0-9532-75cea4ce0e0b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"l1", ",", "l6", ",", "0", ",", "l9", ",", "l10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l6", ",", "l2", ",", "l7", ",", "0", ",", "l11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "l7", ",", "l3", ",", "l8", ",", "l12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l9", ",", "0", ",", "l8", ",", "l4", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l10", ",", "l11", ",", "l12", ",", "0", ",", "l5"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.863158913405357*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"18cb856d-4f08-4ac5-b071-38b374c33071"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"L", "=", 
  RowBox[{"{", 
   RowBox[{
   "l1", ",", "l2", ",", "l3", ",", "l4", ",", "l5", ",", "l6", ",", "l7", 
    ",", "l8", ",", "l9", ",", "l10", ",", "l11", ",", "l12"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.863158865997734*^9, 3.86315886852479*^9}, {
  3.8631594501254683`*^9, 3.863159467814561*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"8b0bb5a8-fdc8-4f7f-8dd9-547e3720d448"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "l1", ",", "l2", ",", "l3", ",", "l4", ",", "l5", ",", "l6", ",", "l7", ",",
    "l8", ",", "l9", ",", "l10", ",", "l11", ",", "l12"}], "}"}]], "Output",
 CellChangeTimes->{3.863159469554118*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"ca03088c-e494-4126-9f54-e9272aad9aec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"listCoef", "[", 
   RowBox[{"[", "1", "]"}], "]"}], ".", "L"}]], "Input",
 CellChangeTimes->{{3.86316416333082*^9, 3.863164164049992*^9}, {
  3.863164210165802*^9, 3.863164218701131*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"84dd9aba-80bd-4d56-b06f-29b5aaecd4fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"93", " ", "l1"}], "+", 
  RowBox[{"254", " ", "l10"}], "+", 
  RowBox[{"112", " ", "l11"}], "+", 
  RowBox[{"203", " ", "l12"}], "+", 
  RowBox[{"742", " ", "l2"}], "+", 
  RowBox[{"552", " ", "l3"}], "+", 
  RowBox[{"568", " ", "l4"}], "+", 
  RowBox[{"549", " ", "l5"}], "+", 
  RowBox[{"136", " ", "l6"}], "+", 
  RowBox[{"874", " ", "l7"}], "+", 
  RowBox[{"465", " ", "l8"}], "+", 
  RowBox[{"3", " ", "l9"}]}]], "Output",
 CellChangeTimes->{
  3.863164164587048*^9, {3.8631642135730047`*^9, 3.8631642190847673`*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"f0d64696-548e-4c7e-b4a4-ae9e89285494"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"SemidefiniteOptimization", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"listCoef", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ".", "L"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"K", 
       UnderscriptBox["\[VectorGreaterEqual]", 
        TemplateBox[{"5"},
         "SemidefiniteConeList"]], "0"}], ",", 
      RowBox[{
       RowBox[{"Tr", "[", "K", "]"}], "\[Equal]", "1"}]}], "}"}], ",", "L"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.863164300790951*^9, 3.863164366748732*^9}, {
  3.8631644307768593`*^9, 3.8631644322151613`*^9}, {3.86316453394357*^9, 
  3.8631645345512323`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"9b8d4c3e-c032-4373-9205-6cff2dcd372c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"l1", "\[Rule]", "0.9362799409855523`"}], ",", 
   RowBox[{"l2", "\[Rule]", "0.0058184377683885005`"}], ",", 
   RowBox[{"l3", "\[Rule]", 
    RowBox[{"-", "4.695693887088327`*^-10"}]}], ",", 
   RowBox[{"l4", "\[Rule]", 
    RowBox[{"-", "5.315979991232236`*^-10"}]}], ",", 
   RowBox[{"l5", "\[Rule]", "0.057901621983147564`"}], ",", 
   RowBox[{"l6", "\[Rule]", 
    RowBox[{"-", "0.07380844841306079`"}]}], ",", 
   RowBox[{"l7", "\[Rule]", 
    RowBox[{"-", "6.36001205902709`*^-11"}]}], ",", 
   RowBox[{"l8", "\[Rule]", 
    RowBox[{"-", "3.1167190812398585`*^-11"}]}], ",", 
   RowBox[{"l9", "\[Rule]", "4.499940704233611`*^-11"}], ",", 
   RowBox[{"l10", "\[Rule]", 
    RowBox[{"-", "0.23283497965756716`"}]}], ",", 
   RowBox[{"l11", "\[Rule]", "0.01835475462776176`"}], ",", 
   RowBox[{"l12", "\[Rule]", 
    RowBox[{"-", "2.0157660924832778`*^-11"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.863164348330701*^9, 3.8631644361282797`*^9, 
  3.863164536495586*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"2795fdad-a8a2-464b-89bb-c0c9f37b5901"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"estK", "=", 
  RowBox[{"K", "/.", "sol"}]}]], "Input",
 CellChangeTimes->{{3.863164815212487*^9, 3.863164839035057*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"c753e95c-412e-4318-81c7-497ea1356d15"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.9362799409855523`", ",", 
     RowBox[{"-", "0.07380844841306079`"}], ",", "0", ",", 
     "4.499940704233611`*^-11", ",", 
     RowBox[{"-", "0.23283497965756716`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.07380844841306079`"}], ",", "0.0058184377683885005`", 
     ",", 
     RowBox[{"-", "6.36001205902709`*^-11"}], ",", "0", ",", 
     "0.01835475462776176`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "6.36001205902709`*^-11"}], ",", 
     RowBox[{"-", "4.695693887088327`*^-10"}], ",", 
     RowBox[{"-", "3.1167190812398585`*^-11"}], ",", 
     RowBox[{"-", "2.0157660924832778`*^-11"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.499940704233611`*^-11", ",", "0", ",", 
     RowBox[{"-", "3.1167190812398585`*^-11"}], ",", 
     RowBox[{"-", "5.315979991232236`*^-10"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.23283497965756716`"}], ",", "0.01835475462776176`", ",", 
     
     RowBox[{"-", "2.0157660924832778`*^-11"}], ",", "0", ",", 
     "0.057901621983147564`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.863164818755684*^9, 3.863164839409226*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"2c08dd59-0a08-46fa-9ba3-3bcee204c2c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixRank", "[", 
  RowBox[{
   RowBox[{"N", "[", "estK", "]"}], ",", 
   RowBox[{"Tolerance", "\[Rule]", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "8"}], ")"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8631648417731857`*^9, 3.863164870067527*^9}, {
  3.863165039246022*^9, 3.86316506484052*^9}, {3.863165110898156*^9, 
  3.863165116659623*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"19bb93a0-55ed-465a-8b42-36f41356fb21"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.863164847131095*^9, 3.863164870454226*^9}, 
   3.8631650704047747`*^9, 3.863165119044999*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"d1128df1-4c84-491d-b21e-9592a5ac545e"]
}, Open  ]]
},
WindowSize->{808, 460},
WindowMargins->{{Automatic, 180}, {Automatic, 134}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"644efd36-5e55-468f-9a26-46ac7f77255c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 484, 11, 73, "Input",ExpressionUUID->"035f4b7c-e822-4e5e-b762-8e43c803c8d8"],
Cell[1067, 35, 2176, 54, 272, "Output",ExpressionUUID->"8ff6bc2c-792e-4a31-82a5-af3672736709"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3280, 94, 754, 17, 52, "Input",ExpressionUUID->"7c0293f1-c2e4-43c0-9532-75cea4ce0e0b"],
Cell[4037, 113, 646, 15, 56, "Output",ExpressionUUID->"18cb856d-4f08-4ac5-b071-38b374c33071"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4720, 133, 419, 9, 30, "Input",ExpressionUUID->"8b0bb5a8-fdc8-4f7f-8dd9-547e3720d448"],
Cell[5142, 144, 316, 6, 34, "Output",ExpressionUUID->"ca03088c-e494-4126-9f54-e9272aad9aec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5495, 155, 301, 6, 30, "Input",ExpressionUUID->"84dd9aba-80bd-4d56-b06f-29b5aaecd4fd"],
Cell[5799, 163, 636, 16, 34, "Output",ExpressionUUID->"f0d64696-548e-4c7e-b4a4-ae9e89285494"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6472, 184, 730, 19, 50, "Input",ExpressionUUID->"9b8d4c3e-c032-4373-9205-6cff2dcd372c"],
Cell[7205, 205, 1107, 24, 81, "Output",ExpressionUUID->"2795fdad-a8a2-464b-89bb-c0c9f37b5901"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8349, 234, 223, 4, 30, "Input",ExpressionUUID->"c753e95c-412e-4318-81c7-497ea1356d15"],
Cell[8575, 240, 1320, 31, 129, "Output",ExpressionUUID->"2c08dd59-0a08-46fa-9ba3-3bcee204c2c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9932, 276, 474, 11, 30, "Input",ExpressionUUID->"19bb93a0-55ed-465a-8b42-36f41356fb21"],
Cell[10409, 289, 223, 3, 34, "Output",ExpressionUUID->"d1128df1-4c84-491d-b21e-9592a5ac545e"]
}, Open  ]]
}
]
*)

