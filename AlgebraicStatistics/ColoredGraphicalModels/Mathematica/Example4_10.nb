(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13533,        370]
NotebookOptionsPosition[     12770,        350]
NotebookOutlinePosition[     13166,        366]
CellTagsIndexPosition[     13123,        363]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"numVar", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTrials", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listCoef", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"1000", ",", 
     RowBox[{"{", 
      RowBox[{"numTrials", ",", "numVar"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"K", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"A1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A4", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A5", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A6", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A7", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A8", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A9", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A10", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A11", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A12", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
    "A1", ",", "A2", ",", "A3", ",", "A4", ",", "A5", ",", "A6", ",", "A7", 
     ",", "A8", ",", "A9", ",", "A10", ",", "A11", ",", "A12"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{"{", 
    RowBox[{
    "l1", ",", "l2", ",", "l3", ",", "l4", ",", "l5", ",", "l6", ",", "l7", 
     ",", "l8", ",", "l9", ",", "l10", ",", "l11", ",", "l12"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{
     RowBox[{"Length", "[", "L", "]"}], "+", "1"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"AddTo", "[", 
    RowBox[{"K", ",", 
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "*", 
      RowBox[{"A", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"estRank", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"solL", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{"numTrials", "+", "1"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"SemidefiniteOptimization", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"listCoef", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ".", "L"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"K", 
          UnderscriptBox["\[VectorGreaterEqual]", 
           TemplateBox[{
             RowBox[{"Length", "[", "K", "]"}]},
            "SemidefiniteConeList"]], "0"}], ",", 
         RowBox[{
          RowBox[{"Tr", "[", "K", "]"}], "\[Equal]", "1"}]}], "}"}], ",", 
       "L"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"solL", ",", "sol"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"estK", "=", 
     RowBox[{"K", "/.", "sol"}]}], ";", 
    RowBox[{"estRankK", "=", 
     RowBox[{"MatrixRank", "[", 
      RowBox[{
       RowBox[{"N", "[", "estK", "]"}], ",", 
       RowBox[{"Tolerance", "\[Rule]", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "8"}], ")"}]}]}]}], "]"}]}], ";", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"estRank", ",", "estRankK"}], "]"}]}]}], "]"}], "\n", 
 RowBox[{"Counts", "[", "estRank", "]"}]}], "Input",
 CellChangeTimes->{{3.863158244873234*^9, 3.863158368163331*^9}, 
   3.863165678287759*^9, 3.863166172696755*^9, {3.863166305571546*^9, 
   3.863166329996912*^9}, {3.8631667151311417`*^9, 3.863166716027321*^9}, {
   3.863169414551627*^9, 3.863169466807105*^9}, {3.863169530723637*^9, 
   3.863169846910844*^9}, {3.863169893968185*^9, 3.863169919050387*^9}, {
   3.863170872430676*^9, 3.863170900824431*^9}, {3.863712088738186*^9, 
   3.863712114603136*^9}, {3.8637121471447268`*^9, 3.863712181575921*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"035f4b7c-e822-4e5e-b762-8e43c803c8d8"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"1", "\[Rule]", "88"}], ",", 
   RowBox[{"2", "\[Rule]", "12"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.863166307775897*^9, 3.863166331672203*^9}, 
   3.863166719412259*^9, 3.863169412255439*^9, 3.8631694706982203`*^9, 
   3.8631709043524*^9, 3.863229565768311*^9, 3.863712150427239*^9, 
   3.863712184966606*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"307a98d0-62c8-45c0-a557-b67ba24a93fb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"solL", ";"}]], "Input",
 CellChangeTimes->{{3.863712192041223*^9, 3.863712204602214*^9}, {
  3.863752229031808*^9, 3.86375223500362*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"5a4d4080-6e48-4431-a489-47f21625d084"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"{", 
    RowBox[{
    "t1", ",", "t2", ",", "t3", ",", "t4", ",", "t5", ",", "t6", ",", "t7", 
     ",", "t8", ",", "t9", ",", "t10", ",", "t11", ",", "t12"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8631691584826097`*^9, 3.8631691753139963`*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"637a3c9c-85a7-4e4b-bb2e-e783521af314"],

Cell[BoxData[
 RowBox[{"K", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l1", ",", "l6", ",", "0", ",", "l9", ",", "l10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l6", ",", "l2", ",", "l7", ",", "0", ",", "l11"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "l7", ",", "l3", ",", "l8", ",", "l12"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l9", ",", "0", ",", "l8", ",", "l4", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l10", ",", "l11", ",", "l12", ",", "0", ",", "l5"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{
  3.863230138489379*^9, {3.8637120233534203`*^9, 
   3.863712023768722*^9}},ExpressionUUID->"e6e31478-748a-46b3-8af5-\
046693c20251"]
},
WindowSize->{808, 460},
WindowMargins->{{Automatic, 180}, {Automatic, 134}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"644efd36-5e55-468f-9a26-46ac7f77255c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 10329, 276, 636, "Input",ExpressionUUID->"035f4b7c-e822-4e5e-b762-8e43c803c8d8"],
Cell[10912, 300, 481, 9, 34, "Output",ExpressionUUID->"307a98d0-62c8-45c0-a557-b67ba24a93fb"]
}, Open  ]],
Cell[11408, 312, 240, 4, 85, "Input",ExpressionUUID->"5a4d4080-6e48-4431-a489-47f21625d084"],
Cell[11651, 318, 398, 10, 30, "Input",ExpressionUUID->"637a3c9c-85a7-4e4b-bb2e-e783521af314"],
Cell[12052, 330, 714, 18, 52, "Input",ExpressionUUID->"e6e31478-748a-46b3-8af5-046693c20251"]
}
]
*)

